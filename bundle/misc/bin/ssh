#!/bin/sh
# ssh has no way to tell gpg-agent where we are!
# so ... We gotta tell the agent first

ps -ef | grep ${SSH_AGENT_PID} 2> /dev/null | grep gpg-agent >/dev/null && {
  echo UPDATESTARTUPTTY | gpg-connect-agent > /dev/null
}

# ok, now we can run ssh
if [[ -x /opt/local/bin/ssh ]] ; then
  /opt/local/bin/ssh $@
elif [[ -x /usr/bin/ssh ]] ; then
  /usr/bin/ssh $@
else
  echo "ssh is not in an expected location" &>2
fi
